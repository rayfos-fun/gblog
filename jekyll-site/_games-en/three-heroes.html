---
title: "Three Heroes Combating Lü Bu"
layout: post
lang: en
permalink: /en/game/three-heroes/
type: "game"
date: 2025-08-28
---
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
#game-wrapper {
  background-color: #1a1a1a;
  color: #00ff00;
  font-family: 'Inter', monospace, sans-serif;
  display: flex;
  justify-content: flex-start;
  align-items: center;
  height: 100vh;
  margin: 0;
  padding: 20px;
  box-sizing: border-box;
  line-height: 1.5;
  flex-direction: column;
}

#game-container {
  width: 100%;
  max-width: 800px;
  height: 80vh;
  display: flex;
  flex-direction: column;
  border: 2px solid #00ff00;
  border-radius: 12px;
  padding: 20px;
  background-color: #000;
  box-shadow: 0 0 20px #00ff00;
}

#game-output {
  flex-grow: 1;
  overflow-y: auto;
  white-space: pre-wrap;
  border-bottom: 2px solid #00ff00;
  padding-bottom: 20px;
  margin-bottom: 20px;
}

#game-controls {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.button-group {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.choice-button, .action-button {
  padding: 10px 20px;
  font-family: 'Inter', monospace, sans-serif;
  font-size: 16px;
  background-color: #004d00;
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s, transform 0.1s;
}

.action-button:disabled {
  background-color: #333;
  color: #666;
  cursor: not-allowed;
  border-color: #666;
}

.choice-button:hover, .action-button:not(:disabled):hover {
  background-color: #006600;
  transform: translateY(-2px);
}

.choice-button:active, .action-button:not(:disabled):active {
  transform: translateY(0);
}

.status-section {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.character-status {
  flex: 1;
  min-width: 180px;
}

.status-bar {
  background-color: #333;
  color: #fff;
  padding: 8px;
  border-radius: 4px;
  margin-top: 5px;
  position: relative;
  height: 25px;
  overflow: hidden;
}

.hp-bar {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  background-color: #ff4d4d;
  transition: width 0.5s ease-in-out;
}

.fury-bar {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  background-color: #ffd700;
  transition: width 0.5s ease-in-out;
}

.hp-text, .fury-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1;
  font-size: 14px;
  color: white;
  text-shadow: 1px 1px 2px black;
}

h1 {
  color: #ffcc00;
  text-shadow: 2px 2px 4px #000;
  margin-bottom: 20px;
}
</style>
<div id="game-wrapper">
  <div id="game-container">
    <div id="game-output"></div>
    <div id="game-controls">
      <div id="status-section" class="status-section"></div>
      <div id="choice-buttons" class="button-group" style="display: none;"></div>
      <div id="action-buttons" class="button-group">
        <button class="action-button" id="attack-btn">Attack</button>
        <button class="action-button" id="musou-btn">Musou</button>
        <button class="action-button" id="flee-btn">Run away</button>
      </div>
    </div>
  </div>
</div>
<script>
const output = document.getElementById('game-output');
const attackBtn = document.getElementById('attack-btn');
const musouBtn = document.getElementById('musou-btn');
const fleeBtn = document.getElementById('flee-btn');
const actionButtonsDiv = document.getElementById('action-buttons');
const statusSection = document.getElementById('status-section');
const gameControlsDiv = document.getElementById('game-controls');

const characters = {
  'Lü Bu': { name: 'Lü Bu', hp: 500, maxHp: 500, atk: 60, fury: 0, maxFury: 100, def: 0, quote: 'I am the number one mighty general of the Three Kingdoms!' },
  'Liu Bei': { name: 'Liu Bei', hp: 250, maxHp: 250, atk: 25, quote: 'There is no place for both the Han and the usurper.' },
  'Guan Yu': { name: 'Guan Yu', hp: 350, maxHp: 350, atk: 40, quote: 'Hua Xiong dies while the wine is still warm.' },
  'Zhang Fei': { name: 'Zhang Fei', hp: 300, maxHp: 300, atk: 35, quote: 'Who dares to fight me to the death!' }
};

let playerCharacter = null;
let enemies = [];
let isMusouActive = false;

function print(message) {
  const text = `> ${message}\n`;
  output.textContent += text;
  output.scrollTop = output.scrollHeight; // auto scroll
}

function updateStatusDisplay() {
  statusSection.innerHTML = '';
  
  enemies.forEach(enemy => {
    const enemyStatusHTML = `
      <div class="character-status">
        <div>${enemy.name}</div>
        <div class="status-bar">
          <div class="hp-bar" style="width: ${Math.max(0, (enemy.hp / enemy.maxHp) * 100)}%;"></div>
          <span class="hp-text">HP: ${Math.max(0, enemy.hp)} / ${enemy.maxHp}</span>
        </div>
      </div>
    `;
    statusSection.innerHTML += enemyStatusHTML;
  });
  
  const playerStatusHTML = `
    <div class="character-status">
      <div style="color: #ffcc00;">${playerCharacter.name} (Player)</div>
      <div class="status-bar">
        <div class="hp-bar" style="width: ${Math.max(0, (playerCharacter.hp / playerCharacter.maxHp) * 100)}%;"></div>
        <span class="hp-text">HP: ${Math.max(0, playerCharacter.hp)} / ${playerCharacter.maxHp}</span>
      </div>
      <div class="status-bar" style="margin-top: 5px;">
        <div class="fury-bar" style="width: ${Math.min(100, playerCharacter.fury)}%;"></div>
        <span class="fury-text">Rage: ${Math.min(100, playerCharacter.fury)} / ${playerCharacter.maxFury}</span>
      </div>
    </div>
  `;
  statusSection.innerHTML += playerStatusHTML;

  musouBtn.disabled = playerCharacter.fury < 100;
}

function startGame() {
  const oldRestartGroup = document.querySelector('#game-controls .button-group:not(#action-buttons)');
  if (oldRestartGroup) {
    oldRestartGroup.remove();
  }

  output.textContent = '';

  playerCharacter = { ...characters['Lü Bu'] };
  enemies = [
    { ...characters['Liu Bei'] },
    { ...characters['Guan Yu'] },
    { ...characters['Zhang Fei'] }
  ];

  print('Lü Bu v.s. Liu Bei、Guan Yu、Zhang Fei');
  print(`${playerCharacter.name}: ${playerCharacter.quote}`);
  
  updateStatusDisplay();
  print('Fight!');

  actionButtonsDiv.style.display = 'flex';
}

function attackEnemy() {
  if (!playerCharacter || enemies.length === 0) return;
  
  // remove Musou
  if (isMusouActive) {
    isMusouActive = false;
  }

  // pick an enemy to attack
  const aliveEnemies = enemies.filter(enemy => enemy.hp > 0);
  if (aliveEnemies.length === 0) {
    print('\nCongratulations! You defeated all enemies!');
    endGame();
    return;
  }

  const targetEnemy = aliveEnemies[Math.floor(Math.random() * aliveEnemies.length)];
  const playerDamage = Math.floor(Math.random() * (playerCharacter.atk * 0.4) + playerCharacter.atk * 0.8);
  
  print(`You made ${playerDamage} damages to ${targetEnemy.name}!`);
  targetEnemy.hp -= playerDamage;
  playerCharacter.fury += 50;
  updateStatusDisplay();
  
  if (targetEnemy.hp <= 0) {
    print(`\nYou defeated ${targetEnemy.name}！`);
  }

  if (enemies.every(enemy => enemy.hp <= 0)) {
    print('\nCongratulations! You defeated all enemies!');
    endGame();
    return;
  }

  print("\nOpponents' turn...");
  aliveEnemies.forEach(enemy => {
    const enemyDamage = Math.floor(Math.random() * (enemy.atk * 0.4) + enemy.atk * 0.8);
    
    let actualDamage = isMusouActive ? Math.max(0, enemyDamage - playerCharacter.def) : enemyDamage;
    
    print(`${enemy.name} made ${actualDamage} damages to you!`);
    playerCharacter.hp -= actualDamage;
  });
  updateStatusDisplay();

  if (playerCharacter.hp <= 0) {
    print(`\nYou are defeated...`);
    endGame();
    return;
  }
  
  print('\nPlease decide what to do next...');
}

function useMusou() {
  if (!playerCharacter || enemies.length === 0) return;
  
  if (playerCharacter.fury < 100) {
    print('\nInsufficient rage!');
    return;
  }
  
  const aliveEnemies = enemies.filter(enemy => enemy.hp > 0);
  if (aliveEnemies.length === 0) {
    print('\nNo more enemies around, no need to Musou.');
    return;
  }

  print(`\n${playerCharacter.name} made the Musou!`);
  const musouDamage = Math.floor(playerCharacter.atk * 2); // twice
  playerCharacter.fury -= 100;
  isMusouActive = true;
  playerCharacter.def = 15; // defense up during Musou
  print(`Defense up!`);
  
  aliveEnemies.forEach(enemy => {
    print(`Musou power made ${musouDamage} damages to ${enemy.name}!`);
    enemy.hp -= musouDamage;
    if (enemy.hp <= 0) {
      print(`${enemy.name} was defeated!`);
    }
  });
  updateStatusDisplay();

  // 檢查是否所有敵人都被擊敗
  if (enemies.every(enemy => enemy.hp <= 0)) {
    print('\nCongratulations! You defeated all enemies and won!');
    endGame();
    return;
  }

  // Counter back
  print("\nOpponents' turn...");
  aliveEnemies.forEach(enemy => {
    if (enemy.hp > 0) {
      const enemyDamage = Math.floor(Math.random() * (enemy.atk * 0.4) + enemy.atk * 0.8);
      
      let actualDamage = isMusouActive ? Math.max(0, enemyDamage - playerCharacter.def) : enemyDamage;

      print(`${enemy.name} made ${actualDamage} damages to you!`);
      playerCharacter.hp -= actualDamage;
    }
  });
  
  // Musou only last single turn
  isMusouActive = false;
  playerCharacter.def = 0;

  updateStatusDisplay();

  if (playerCharacter.hp <= 0) {
    print(`\nYou were defeated...`);
    endGame();
    return;
  }

  print('\nPlease decide what to do next...');
}

function flee() {
  print(`\nYou've run away...`);
  print(`The fight is over.`);
  endGame();
}

function endGame() {
  actionButtonsDiv.style.display = 'none';
  
  const restartButton = document.createElement('button');
  restartButton.classList.add('choice-button');
  restartButton.textContent = 'Restart';
  restartButton.onclick = () => {
    startGame();
    actionButtonsDiv.style.display = 'flex';
  };
  const restartGroup = document.createElement('div');
  restartGroup.classList.add('button-group');
  restartGroup.appendChild(restartButton);
  gameControlsDiv.appendChild(restartGroup);
}

document.getElementById('attack-btn').onclick = attackEnemy;
document.getElementById('musou-btn').onclick = useMusou;
document.getElementById('flee-btn').onclick = flee;

startGame();
</script>
